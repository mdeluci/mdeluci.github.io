---
layout: post
title: Solving the Cahn-Hilliard equation on complex geometries
date: 2015-10-20 11:12:00-0400
description: an example of a blog post with some math
tags: formatting math
categories: sample-posts
related_posts: false
---

## The Canh-Hilliard equation
Cahnâ€“Hilliard equation describes the process of phase separation, by which the two components of a binary fluid spontaneously separate and form domains pure in each component. It was originally proposed in 1958 to model phase separation in binary alloys \cite{Cahn-Hilliard, Cahn-Hilliard2}. Since then it has been used to describe various phenomena, such as spinodal decomposition \cite{MARALDI201231}, diblock copolymer \cite{Choksi,JEONG20141263}, image inpainting \cite{4032803}, tumor growth simulation \cite{tumor,WISE2008524} or multiphase fluid flows \cite{BADALASSI2003371, Kotschote}. 

There are two main approaches to describing phase transition phenomena: sharp-interface models and phase-field models. Sharp-interface models involve the resolution of a moving boundary problem, meaning that partial differential equations have to be solved for each phase. This can lead to physical \cite{Anderson} and computational complications \cite{Barrett}, such as jump discontinuities across the interface. Phase-field models replace sharp-interfaces by thin transitions regions where the interfacial forces are smoothly distributed (diffuse interfaces). For this reason, phase-field models are also referred to as \emph{diffuse interface} models, and they are emerging as a promising tool to treat problems with interfaces.  

From the mathematical point of view, the Cahn-Hilliard equation is a stiff, fourth-order, nonlinear parabolic partial differential equation. The elementary form of the Cahn-Hilliard equation is given by

\begin{equation}
    \frac{\partial \phi}{\partial t}=\nabla \cdot \left(m\left(\phi\right) \nabla \left(W'\left(\phi\right) -\epsilon  ^2 \Delta \phi \right)  \right)
    \label{element}
\end{equation} 


where $\phi\left(\mathbf{x},t\right) \in [-1,1]$ represents the phase-field variable, which describes the location of different components (e.g., $\phi=-1$ in oil and $\phi=1$ in water), $m\left(\phi\right)$ is the mobility, $W\left(\phi\right)$ is the so-called double-well potential, and $\epsilon$ is a length scale related to the thickness of the diffuse interface. 

Two different approaches have been used to solve the Cahn-Hilliard equation: solving the original form given by Eqn.~\eqref{element}, which involves fourth-order operators, or by splitting it into two second order partial differential equations by introducing an auxiliary variable --- the chemical potential $\mu$. The split version of the equation is given by

\begin{equation}
    \frac{\partial \phi}{\partial t}=\nabla \cdot \left(m\left(\phi\right) \nabla \mu \right)
    \label{split1}
\end{equation}
\begin{equation}
\mu=W'\left(\phi \right) - \epsilon^2 \Delta \phi.
\label{chempot}
\end{equation}

The splitting strategy was proposed by Elliot \cite{Elliott1989ASO} to avoid constraints related to the continuity of the basis functions when using the finite element method with a primal formulation. It also facilitates the imposition of the boundary conditions on a circular geometry, which is the case we are interested in. Unfortunately, this comes at a price of an additional degree of freedom introduced into the solver. Nevertheless, this reformulation reduces the complexity of the problem from the numerical point of view (see \cite{M2AN_2009__43_5_1003_0,Zee}).

The spatial discretization of the governing equations is performed using isogeometric analysis (IGA) \cite{HUGHES20054135}. IGA is a generalization of the finite-element method that uses non-uniform rational B-splines (NURBS) to define the discrete spaces. A significant advantage of IGA with respect to finite element analysis is that the basis functions can be constructed with controllable continuity across the element boundaries, even on mapped geometries. The higher-order global continuity of the basis functions has been shown to produce higher accuracy than classical finite elements for the same number of degrees of freedom \cite{akkerman2008role,evans2009n}; and has been widely used to solve partial differential equations with high-order spatial derivatives \cite{GOMEZ20084333, GOMEZ20101828, GOMEZ201252}. Here, we will use $\mathcal{C}^1$-continuous quadratic splines for $\phi$ and $\mu$.
## Strong form
The strong form of the problem is formulated as follows: find $\phi:\Omega \times \left[0,T\right]\rightarrow \mathbb{R}$ and $\mu:\Omega \times \left[0,T\right]\rightarrow \mathbb{R}$ (being $\mu$ an  auxiliary variable) such that:
\begin{equation}
    \label{st1}
    \frac{\partial \phi}{\partial t}=\nabla \cdot \left(m\left(\phi\right) \nabla \mu\right) \quad \text{in} \ \Omega \times \left[0,T\right], 
\end{equation}   
\begin{equation}
    \label{st2} 
    \mu=W'\left(\phi\right)-\epsilon^2 \Delta \phi \quad \text{in} \ \Omega \times \left[0,T\right], 
\end{equation} 
\begin{equation} 
    \phi=g \quad \text{on} \ \Gamma_g \times \left[0,T\right], \label{st3} 
\end{equation} 
\begin{equation}    
    m\left(\phi\right)\epsilon^2\Delta\phi=q \quad \text{on} \ \Gamma_q \times \left[0,T\right], \label{st4}
\end{equation} 
\begin{equation}
    \nabla\left(m\left(\phi\right)\mu\right)\cdot \mathbf{n}=s \quad \text{on} \ \Gamma_s \times \left[0,T\right], \label{st5}
\end{equation} 
\begin{equation}
    \nabla\left(m\left(\phi\right)\phi\right)\cdot \mathbf{n}=h \quad \text{on} \ \Gamma_h \times \left[0,T\right], \label{st6}  
\end{equation} 
\begin{equation}
    \phi\left(\mathbf{x},0\right)=\phi_0\left(\mathbf{x}\right) \quad \text{in} \ \Omega. \label{st7}  
\end{equation} 

and by adding `\label{...}` inside the equation environment, we can now refer to the equation using `\eqref`.

Note that MathJax 3 is [a major re-write of MathJax](https://docs.mathjax.org/en/latest/upgrading/whats-new-3.0.html) that brought a significant improvement to the loading and rendering speed, which is now [on par with KaTeX](http://www.intmath.com/cg5/katex-mathjax-comparison.php).
